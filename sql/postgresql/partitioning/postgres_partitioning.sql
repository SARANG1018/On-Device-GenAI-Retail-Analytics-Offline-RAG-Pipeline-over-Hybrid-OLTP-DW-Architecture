CREATE TABLE IF NOT EXISTS FA25_SSC_FA25_SSC_ORDER_PARTITIONED (
    ROW_ID BIGINT NOT NULL,
    ORDER_ID VARCHAR(50) NOT NULL,
    ORDER_DATE DATE NOT NULL,
    SHIP_DATE DATE,
    SHIP_MODE VARCHAR(50),
    CUSTOMER_ID VARCHAR(50),
    CUSTOMER_NAME VARCHAR(255),
    SEGMENT VARCHAR(50),
    POSTAL_CODE VARCHAR(20),
    CITY VARCHAR(100),
    STATE VARCHAR(100),
    COUNTRY VARCHAR(100),
    REGION VARCHAR(50),
    MARKET VARCHAR(100),
    PRODUCT_ID VARCHAR(50),
    CATEGORY VARCHAR(50),
    SUB_CATEGORY VARCHAR(100),
    PRODUCT_NAME VARCHAR(255),
    SALES NUMERIC(12,2),
    QUANTITY INT,
    DISCOUNT NUMERIC(5,4),
    PROFIT NUMERIC(12,2),
    SHIPPING_COST NUMERIC(12,2),
    ORDER_PRIORITY VARCHAR(20),
    tbl_last_dt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) PARTITION BY RANGE (DATE_TRUNC('month', ORDER_DATE::TIMESTAMP));

-- 2012 Historical (12 partitions)
CREATE TABLE FA25_SSC_FA25_SSC_ORDER_P_2012_01 PARTITION OF FA25_SSC_FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-01-01') TO ('2012-02-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_02 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-02-01') TO ('2012-03-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_03 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-03-01') TO ('2012-04-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_04 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-04-01') TO ('2012-05-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_05 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-05-01') TO ('2012-06-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_06 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-06-01') TO ('2012-07-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_07 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-07-01') TO ('2012-08-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_08 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-08-01') TO ('2012-09-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_09 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-09-01') TO ('2012-10-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_10 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-10-01') TO ('2012-11-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_11 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-11-01') TO ('2012-12-01');
CREATE TABLE FA25_SSC_ORDER_P_2012_12 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2012-12-01') TO ('2013-01-01');

-- 2013 Historical (12 partitions)
CREATE TABLE FA25_SSC_ORDER_P_2013_01 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-01-01') TO ('2013-02-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_02 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-02-01') TO ('2013-03-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_03 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-03-01') TO ('2013-04-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_04 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-04-01') TO ('2013-05-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_05 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-05-01') TO ('2013-06-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_06 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-06-01') TO ('2013-07-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_07 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-07-01') TO ('2013-08-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_08 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-08-01') TO ('2013-09-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_09 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-09-01') TO ('2013-10-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_10 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-10-01') TO ('2013-11-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_11 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-11-01') TO ('2013-12-01');
CREATE TABLE FA25_SSC_ORDER_P_2013_12 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2013-12-01') TO ('2014-01-01');

-- 2014 Historical (12 partitions)
CREATE TABLE FA25_SSC_ORDER_P_2014_01 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-01-01') TO ('2014-02-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_02 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-02-01') TO ('2014-03-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_03 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-03-01') TO ('2014-04-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_04 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-04-01') TO ('2014-05-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_05 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-05-01') TO ('2014-06-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_06 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-06-01') TO ('2014-07-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_07 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-07-01') TO ('2014-08-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_08 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-08-01') TO ('2014-09-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_09 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-09-01') TO ('2014-10-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_10 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-10-01') TO ('2014-11-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_11 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-11-01') TO ('2014-12-01');
CREATE TABLE FA25_SSC_ORDER_P_2014_12 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2014-12-01') TO ('2015-01-01');

-- 2015 Historical (12 partitions)
CREATE TABLE FA25_SSC_ORDER_P_2015_01 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-01-01') TO ('2015-02-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_02 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-02-01') TO ('2015-03-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_03 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-03-01') TO ('2015-04-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_04 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-04-01') TO ('2015-05-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_05 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-05-01') TO ('2015-06-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_06 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-06-01') TO ('2015-07-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_07 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-07-01') TO ('2015-08-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_08 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-08-01') TO ('2015-09-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_09 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-09-01') TO ('2015-10-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_10 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-10-01') TO ('2015-11-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_11 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-11-01') TO ('2015-12-01');
CREATE TABLE FA25_SSC_ORDER_P_2015_12 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2015-12-01') TO ('2016-01-01');

-- 2025 Current Year (12 partitions)
CREATE TABLE FA25_SSC_ORDER_P_2025_01 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_02 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-02-01') TO ('2025-03-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_03 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-03-01') TO ('2025-04-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_04 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-04-01') TO ('2025-05-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_05 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-05-01') TO ('2025-06-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_06 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-06-01') TO ('2025-07-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_07 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-07-01') TO ('2025-08-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_08 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-08-01') TO ('2025-09-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_09 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-09-01') TO ('2025-10-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_10 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-10-01') TO ('2025-11-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_11 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-11-01') TO ('2025-12-01');
CREATE TABLE FA25_SSC_ORDER_P_2025_12 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2025-12-01') TO ('2026-01-01');

-- 2026 Future Year (12 partitions)
CREATE TABLE FA25_SSC_ORDER_P_2026_01 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-01-01') TO ('2026-02-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_02 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-02-01') TO ('2026-03-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_03 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-03-01') TO ('2026-04-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_04 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-04-01') TO ('2026-05-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_05 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-05-01') TO ('2026-06-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_06 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-06-01') TO ('2026-07-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_07 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-07-01') TO ('2026-08-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_08 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-08-01') TO ('2026-09-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_09 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-09-01') TO ('2026-10-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_10 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-10-01') TO ('2026-11-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_11 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-11-01') TO ('2026-12-01');
CREATE TABLE FA25_SSC_ORDER_P_2026_12 PARTITION OF FA25_SSC_ORDER_PARTITIONED FOR VALUES FROM ('2026-12-01') TO ('2027-01-01');

CREATE INDEX idx_FA25_SSC_ORDER_P_order_date ON FA25_SSC_ORDER_PARTITIONED (ORDER_DATE);
CREATE INDEX idx_FA25_SSC_ORDER_P_customer_id ON FA25_SSC_ORDER_PARTITIONED (CUSTOMER_ID);
CREATE INDEX idx_FA25_SSC_ORDER_P_tbl_last_dt ON FA25_SSC_ORDER_PARTITIONED (tbl_last_dt);

INSERT INTO FA25_SSC_ORDER_PARTITIONED
SELECT 
    ROW_ID, ORDER_ID, ORDER_DATE, 
    CURRENT_TIMESTAMP, 'Standard', CUSTOMER_ID, 'Customer',
    'Consumer', '12345', 'City', 'State', 'USA', 'North America', 'Americas', 'PRODUCT-001',
    'Office Supplies', 'Paper', 'Product Name', 100.00, 1, 0.0, 25.00,
    5.00, 'Medium', CURRENT_TIMESTAMP
FROM "FA25_SSC_ORDER";

SELECT COUNT(*) as total_rows FROM FA25_SSC_ORDER_PARTITIONED;
SELECT COUNT(*) as original_rows FROM "FA25_SSC_ORDER";

-- ============================================================================
-- FA25_SSC_RETURN_PARTITIONED table (CORRECTED)
-- ============================================================================

CREATE TABLE FA25_SSC_RETURN_PARTITIONED (
    RETURNED VARCHAR(50),
    ORDER_ID VARCHAR(50) NOT NULL,
    RETURN_DATE DATE NOT NULL,
    REGION VARCHAR(100),
    tbl_last_dt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) PARTITION BY RANGE (DATE_TRUNC('month', RETURN_DATE::TIMESTAMP));

-- 2012 Historical (12 partitions)
CREATE TABLE FA25_SSC_RETURN_P_2012_01 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-01-01') TO ('2012-02-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_02 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-02-01') TO ('2012-03-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_03 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-03-01') TO ('2012-04-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_04 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-04-01') TO ('2012-05-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_05 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-05-01') TO ('2012-06-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_06 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-06-01') TO ('2012-07-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_07 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-07-01') TO ('2012-08-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_08 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-08-01') TO ('2012-09-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_09 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-09-01') TO ('2012-10-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_10 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-10-01') TO ('2012-11-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_11 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-11-01') TO ('2012-12-01');
CREATE TABLE FA25_SSC_RETURN_P_2012_12 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2012-12-01') TO ('2013-01-01');

-- 2013 Historical (12 partitions)
CREATE TABLE FA25_SSC_RETURN_P_2013_01 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-01-01') TO ('2013-02-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_02 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-02-01') TO ('2013-03-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_03 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-03-01') TO ('2013-04-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_04 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-04-01') TO ('2013-05-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_05 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-05-01') TO ('2013-06-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_06 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-06-01') TO ('2013-07-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_07 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-07-01') TO ('2013-08-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_08 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-08-01') TO ('2013-09-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_09 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-09-01') TO ('2013-10-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_10 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-10-01') TO ('2013-11-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_11 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-11-01') TO ('2013-12-01');
CREATE TABLE FA25_SSC_RETURN_P_2013_12 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2013-12-01') TO ('2014-01-01');

-- 2014 Historical (12 partitions)
CREATE TABLE FA25_SSC_RETURN_P_2014_01 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-01-01') TO ('2014-02-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_02 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-02-01') TO ('2014-03-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_03 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-03-01') TO ('2014-04-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_04 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-04-01') TO ('2014-05-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_05 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-05-01') TO ('2014-06-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_06 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-06-01') TO ('2014-07-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_07 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-07-01') TO ('2014-08-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_08 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-08-01') TO ('2014-09-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_09 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-09-01') TO ('2014-10-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_10 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-10-01') TO ('2014-11-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_11 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-11-01') TO ('2014-12-01');
CREATE TABLE FA25_SSC_RETURN_P_2014_12 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2014-12-01') TO ('2015-01-01');

-- 2015 Historical (12 partitions)
CREATE TABLE FA25_SSC_RETURN_P_2015_01 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-01-01') TO ('2015-02-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_02 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-02-01') TO ('2015-03-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_03 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-03-01') TO ('2015-04-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_04 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-04-01') TO ('2015-05-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_05 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-05-01') TO ('2015-06-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_06 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-06-01') TO ('2015-07-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_07 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-07-01') TO ('2015-08-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_08 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-08-01') TO ('2015-09-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_09 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-09-01') TO ('2015-10-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_10 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-10-01') TO ('2015-11-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_11 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-11-01') TO ('2015-12-01');
CREATE TABLE FA25_SSC_RETURN_P_2015_12 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2015-12-01') TO ('2016-01-01');

-- 2025 Current Year (12 partitions)
CREATE TABLE FA25_SSC_RETURN_P_2025_01 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_02 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-02-01') TO ('2025-03-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_03 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-03-01') TO ('2025-04-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_04 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-04-01') TO ('2025-05-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_05 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-05-01') TO ('2025-06-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_06 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-06-01') TO ('2025-07-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_07 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-07-01') TO ('2025-08-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_08 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-08-01') TO ('2025-09-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_09 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-09-01') TO ('2025-10-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_10 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-10-01') TO ('2025-11-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_11 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-11-01') TO ('2025-12-01');
CREATE TABLE FA25_SSC_RETURN_P_2025_12 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2025-12-01') TO ('2026-01-01');

-- 2026 Future Year (12 partitions)
CREATE TABLE FA25_SSC_RETURN_P_2026_01 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-01-01') TO ('2026-02-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_02 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-02-01') TO ('2026-03-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_03 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-03-01') TO ('2026-04-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_04 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-04-01') TO ('2026-05-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_05 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-05-01') TO ('2026-06-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_06 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-06-01') TO ('2026-07-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_07 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-07-01') TO ('2026-08-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_08 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-08-01') TO ('2026-09-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_09 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-09-01') TO ('2026-10-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_10 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-10-01') TO ('2026-11-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_11 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-11-01') TO ('2026-12-01');
CREATE TABLE FA25_SSC_RETURN_P_2026_12 PARTITION OF FA25_SSC_RETURN_PARTITIONED FOR VALUES FROM ('2026-12-01') TO ('2027-01-01');

CREATE INDEX idx_FA25_SSC_RETURN_P_return_date ON FA25_SSC_RETURN_PARTITIONED (RETURN_DATE);
CREATE INDEX idx_FA25_SSC_RETURN_P_order_id ON FA25_SSC_RETURN_PARTITIONED (ORDER_ID);

INSERT INTO FA25_SSC_RETURN_PARTITIONED (RETURNED, ORDER_ID, RETURN_DATE, REGION)
SELECT r.return_status, r.order_id, 
       o.order_date,
       r.return_region
FROM "FA25_SSC_RETURN" r
JOIN "FA25_SSC_ORDER" o ON r.order_id = o.order_id;

SELECT COUNT(*) as return_rows FROM FA25_SSC_RETURN_PARTITIONED;

SELECT 'Orders partitioned' as action, COUNT(*) as rows FROM FA25_SSC_ORDER_PARTITIONED
UNION ALL
SELECT 'Returns partitioned' as action, COUNT(*) as rows FROM FA25_SSC_RETURN_PARTITIONED;

